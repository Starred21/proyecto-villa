try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{})["__faroBundleId_gptengineer-app"]="1764611182484c28deb7899"}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1487],{10580:(e,s,l)=>{l.d(s,{y:()=>i});var t=l(77145),a=l(30849),r=l(13410),n=l(52811);let i=e=>{let{imageSrc:s,imageAlt:l,title:i,subtitle:c,buttonText:d,buttonHref:o,onButtonClick:u}=e,m=(0,r.useRouter)();return(0,t.jsx)("div",{className:"flex h-full flex-col gap-6 rounded-2xl p-8",children:(0,t.jsx)("div",{className:"flex flex-1 items-center justify-center p-6 pb-36",children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,t.jsx)(a.default,{src:"/img/logo/Lovable-heart-dark.png",alt:"Lovable Logo",width:32,height:32,className:"shrink-0"}),(0,t.jsx)("h1",{className:"max-w-[20ch] text-center text-2xl font-medium leading-tight",children:i}),c&&(0,t.jsx)("p",{className:"text-center text-muted-foreground",children:c}),d&&(0,t.jsx)(n.$,{onClick:()=>{u?u():o&&m.push(o)},variant:"outline",className:"mt-2 p-4 font-normal",children:d}),(0,t.jsx)(a.default,{className:"ml-6",src:s,alt:l,width:380,height:380})]})})})}},23293:(e,s,l)=>{l.d(s,{D:()=>c});var t=l(77145),a=l(95661),r=l(73113),n=l(56024),i=l(50562);let c=(0,a.memo)(e=>{let{projects:s,isLoading:l,isSupabaseClickable:a=!1,showAvatar:c=!0,placeholderCount:d=8,selectedCategory:o,subtitleType:u,noProjectsMessage:m="No projects found",skeletonBackgroundColor:h,showStars:x=!1,onToggleStar:p,showActionsDropdown:f=!0,getHref:j,getOnClick:v,getImagePreviewButtonText:g,className:b,selectionMode:N=!1,selectedProjectIds:w,onSelectionChange:y,onSelectModeToggle:k,enableBulkSelection:S=!1}=e,C=s||[],_=l?d-C.length:0;return l||0!==C.length?(0,t.jsxs)("div",{className:(0,n.cn)("grid w-full grid-cols-[repeat(auto-fill,minmax(275px,1fr))] gap-5",b),children:[C.map((e,s)=>(0,t.jsx)("div",{className:"w-full max-w-[400px]",children:(0,t.jsx)(r.U,{project:e,isSupabaseClickable:a,showAvatar:c,selectedCategory:o,subtitleType:u,showStars:x,onToggleStar:p,showActionsDropdown:f,linkHref:null==j?void 0:j(e,s),onClick:null==v?void 0:v(e,s),imagePreviewButtonText:null==g?void 0:g(e),selectionMode:N,isSelected:(null==w?void 0:w.has(e.id))||!1,onSelectionChange:y,onSelectModeToggle:k,enableBulkSelection:S})},e.id)),l&&_>0&&Array.from({length:_}).map((e,s)=>(0,t.jsx)("div",{className:"w-full max-w-[400px]",children:(0,t.jsx)(i.p,{backgroundColor:h})},s))]}):(0,t.jsx)("div",{className:"text-center text-sm text-muted-foreground",children:m})});c.displayName="ProjectsGrid"},37962:(e,s,l)=>{l.d(s,{TU:()=>o,tD:()=>u});var t=l(81496),a=l(21562),r=l(95661),n=l(40911),i=l(99989),c=l(74507);let d=e=>{if(!e)return 0;try{if(e instanceof t.Dc)return e.toDate().getTime();if("number"==typeof e)return isNaN(e)?0:e;if("string"==typeof e){let s=Date.parse(e);return isNaN(s)?0:s}return 0}catch(e){return 0}},o=(e,s,l)=>e.sort((e,t)=>{let a=0;switch(s){case"name":a=(e.name||"").localeCompare(t.name||"");break;case"created_at":a=d(e.created_at)-d(t.created_at);break;default:a=d(e.updated_at)-d(t.updated_at)}return"desc"===l?-a:a}),u=e=>{var s,l;let{workspaceId:t,pageSize:d=12,isDraft:u=!1,enableVisibilityFilter:m=!1,enablePublishStatusFilter:h=!1,enableTwoPhaseLoading:x=!0}=e,[p,f]=(0,r.useState)(""),[j,v]=(0,r.useState)(1),[g,b]=(0,r.useState)("all"),[N,w]=(0,r.useState)("updated_at"),[y,k]=(0,r.useState)("desc"),[S,C]=(0,r.useState)("all"),[_,A]=(0,r.useState)("all"),[P,M]=(0,r.useState)(!1),E=(0,r.useRef)(t);(0,r.useEffect)(()=>{E.current!==t&&(b("all"),w("updated_at"),k("desc"),f(""),C("all"),A("all"),v(1),M(!1),E.current=t)},[t]),(0,r.useEffect)(()=>{v(1),M(!1)},[g,N,y,p,S,_]);let{data:I,isLoading:T,refetch:z}=(0,n.I)({...i.y.projects({workspaceId:t,userId:g,isDraft:u,visibility:m?S:void 0,limit:x?20:void 0}),permission:c.eZ.ViewWorkspaceProjects,enabled:!!t,staleTime:12e4}),{data:F,isLoading:B,refetch:D}=(0,n.I)({...i.y.projects({workspaceId:t,userId:g,isDraft:u,visibility:m?S:void 0}),permission:c.eZ.ViewWorkspaceProjects,enabled:!!t&&x&&!!I&&!P,staleTime:3e5});(0,r.useEffect)(()=>{(null==F?void 0:F.projects)&&M(!0)},[F]);let L=(0,r.useMemo)(()=>x&&(null==F?void 0:F.projects)?F:I,[x,F,I]),$=(0,r.useMemo)(()=>x&&B&&!!I,[x,B,I]),O=(0,r.useMemo)(()=>({keys:[{name:"name",weight:.5},{name:"description",weight:.5},{name:"tech_stack",weight:.3}],threshold:.5,includeScore:!0}),[]),V=(0,r.useMemo)(()=>{let e=null==L?void 0:L.projects;return e?new a.A(e,O):null},[null==L?void 0:L.projects,O]),U=(0,r.useMemo)(()=>{let e=null==L?void 0:L.projects;if(!e)return;let s=[...e];if(h&&"all"!==_&&(s=s.filter(e=>{let s=!0===e.is_published&&"private"===e.publish_visibility,l=!0===e.is_published&&(null==e.publish_visibility||"public"===e.publish_visibility);return"published"===_?s||l:"internally_published"===_?s:"externally_published"===_?l:"unpublished"!==_||!s&&!l})),p.length>0&&V){let e=new Set(V.search(p).map(e=>e.item.id));s=s.filter(s=>e.has(s.id))}return o(s,N,y)},[null==L?void 0:L.projects,p,V,N,y,_,h]),Q=(0,r.useMemo)(()=>{if(U)return U.slice(0,j*d)},[U,j,d]),R=((null==U?void 0:U.length)||0)>j*d;return{projects:Q,allProjects:null==L?void 0:L.projects,isLoading:T,hasMore:R,searchQuery:p,setSearchQuery:f,selectedUserId:g,setSelectedUserId:b,sortBy:N,setSortBy:w,order:y,setOrder:k,visibility:S,setVisibility:C,publishStatus:_,setPublishStatus:A,refetch:()=>{x&&M(!1),z(),x&&D()},showMore:()=>{R&&v(e=>e+1)},isLoadingInBackground:$,allProjectsLoaded:P,totalProjectsCount:(null==F||null==(s=F.projects)?void 0:s.length)||(null==I||null==(l=I.projects)?void 0:l.length)||0}}},43010:(e,s,l)=>{l.d(s,{v:()=>c});var t=l(8105),a=l(95661),r=l(61374),n=l(63851),i=l(74507);function c(e){let{workspaceId:s,searchQuery:l=""}=e,{permitted:c}=(0,r.J)(i.eZ.ViewWorkspaceMembers),{data:d,isLoading:o,error:u,fetchNextPage:m,hasNextPage:h,isFetchingNextPage:x}=(0,t.q)({queryKey:["workspace-members-for-filter",s,l],queryFn:async e=>{let{pageParam:t=0}=e,a=(0,n.P)(),r=new URLSearchParams({limit:"20",offset:t.toString(),status:"active"});l.trim()&&r.append("q",l.trim());let i="/workspaces/".concat(s,"/memberships/search?").concat(r.toString());try{return await a.get(i)}catch(e){throw console.error("\uD83D\uDD0D DEBUG - API error:",e),e}},initialPageParam:0,getNextPageParam:(e,s)=>{let l=20*s.length;if(e.has_more)return l},enabled:!!s&&c,staleTime:0});return{members:(0,a.useMemo)(()=>(null==d?void 0:d.pages.flatMap(e=>e.members))||[],[null==d?void 0:d.pages]),isLoading:o,error:u,fetchNextPage:m,hasNextPage:h,isFetchingNextPage:x}}},50562:(e,s,l)=>{l.d(s,{p:()=>n});var t=l(77145),a=l(47226),r=l(56024);let n=e=>{let{mainSkeletonClassName:s,backgroundColor:l}=e;return l||(l="bg-muted"),(0,t.jsxs)("div",{className:"group flex flex-col",children:[(0,t.jsx)(a.E,{className:(0,r.cn)("mb-3 aspect-video h-full w-full rounded-lg",l,s)}),(0,t.jsxs)("div",{className:"flex flex-col gap-2 py-1",children:[(0,t.jsx)(a.E,{className:(0,r.cn)("h-3.5 w-[150px]",l)}),(0,t.jsx)(a.E,{className:(0,r.cn)("h-3.5 w-[120px]",l)})]})]})}},71487:(e,s,l)=>{l.d(s,{I:()=>ei});var t=l(77145),a=l(26294),r=l(95661),n=l(23293),i=l(30849),c=l(46753),d=l.n(c),o=l(73279),u=l(51385),m=l(52811),h=l(91604),x=l(69730),p=l(47226),f=l(702),j=l(56024),v=l(34217),g=l(73113),b=l(12847);let N=()=>(0,t.jsxs)("div",{className:"flex items-center gap-2 rounded-lg px-3 py-2",children:[(0,t.jsx)(p.E,{className:"h-[60px] w-[126px] flex-shrink-0 rounded-xl"}),(0,t.jsxs)("div",{className:"min-w-0 flex-[6] overflow-hidden",children:[(0,t.jsx)(p.E,{className:"mb-1.5 h-5 w-48"}),(0,t.jsx)(p.E,{className:"h-3.5 w-32"})]}),(0,t.jsx)("div",{className:"flex-[3] overflow-hidden",children:(0,t.jsx)(p.E,{className:"h-3.5 w-24"})}),(0,t.jsxs)("div",{className:"flex flex-[3] items-center gap-2 overflow-hidden",children:[(0,t.jsx)(p.E,{className:"h-7 w-7 flex-shrink-0 rounded-full"}),(0,t.jsx)(p.E,{className:"h-3.5 w-24"})]}),(0,t.jsx)("div",{className:"flex w-20 flex-shrink-0 items-center justify-end",children:(0,t.jsx)(p.E,{className:"h-8 w-8"})})]}),w=e=>{let{project:s,showAvatar:l,subtitleType:a,showStars:r,onToggleStar:n,showActionsDropdown:c,linkHref:p,onClick:N,imagePreviewButtonText:w,selectionMode:y=!1,isSelected:k=!1,onSelectionChange:S,isFirst:C=!1}=e,_=(0,o.Ym)(),A=p||"/projects/".concat(s.id),P=s.created_at?(0,b.P)({updatedAt:s.created_at,locale:_}):"";return(0,t.jsxs)(d(),{href:A,className:"group flex cursor-pointer items-center gap-2 rounded-lg px-3 py-2 hover:bg-muted-hover/30",onClick:e=>{y?(e.preventDefault(),null==S||S(s.id)):N&&(e.preventDefault(),N(e))},children:[y&&(0,t.jsx)("div",{className:"pointer-events-none flex items-center justify-center",children:(0,t.jsx)(h.S,{checked:k,className:"pointer-events-none h-5 w-5"})}),(0,t.jsx)("div",{className:"relative block h-[60px] w-[126px] flex-shrink-0 overflow-hidden rounded-xl bg-muted",children:s.latest_screenshot_url?(0,t.jsx)(i.default,{src:s.latest_screenshot_url.replace("https://pub-bb2e103a32db4e198524a2e9ed8f35b4.r2.dev","https://screenshot2.lovable.dev"),alt:"Screenshot of ".concat(s.display_name||s.name||"project"),fill:!0,sizes:"126px",className:"object-cover object-top"}):(0,t.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,t.jsx)(x.A,{name:"image",className:"h-8 w-8 text-muted-foreground"})})}),(0,t.jsx)("div",{className:"min-w-0 flex-[6] overflow-hidden",children:(0,t.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"truncate text-sm font-medium",children:(0,t.jsx)(v.D,{project:s})}),"draft"===s.visibility&&(0,t.jsx)("span",{className:"flex-shrink-0 rounded bg-muted-foreground/20 px-1.5 py-0.5 text-[10px] font-medium uppercase text-muted-foreground",children:"Draft"})]}),s.updated_at&&(0,t.jsxs)("span",{className:"truncate text-xs text-muted-foreground",children:["Edited ",(0,b.P)({updatedAt:s.updated_at,locale:_})]})]})}),(0,t.jsx)("div",{className:"flex-[3] overflow-hidden text-sm text-muted-foreground",children:(0,t.jsx)("span",{className:"truncate",children:P})}),(0,t.jsx)("div",{className:"flex flex-[3] items-center gap-2 overflow-hidden",children:l&&s.created_by&&(0,t.jsxs)(d(),{href:"/users/".concat(s.created_by),className:"flex min-w-0 items-center gap-2 transition-opacity hover:opacity-80",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)(u.H,{user:{id:s.created_by,username:s.created_by||""},className:"h-7 w-7 flex-shrink-0"}),(0,t.jsx)(f.f,{username:s.created_by,showAsLink:!1,className:"truncate text-sm text-muted-foreground"})]})}),(0,t.jsxs)("div",{className:"flex w-20 flex-shrink-0 items-center justify-end gap-2",onClick:e=>e.stopPropagation(),children:[r&&n&&!y&&(0,t.jsx)(m.$,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 transition-transform md:hover:scale-110",onClick:e=>{e.preventDefault(),e.stopPropagation(),n(s.id)},children:(0,t.jsx)(x.A,{name:s.is_starred?"star_filled":"star",className:(0,j.cn)("h-4 w-4 transition-all duration-200",s.is_starred?"text-yellow-500 drop-shadow-sm":"text-muted-foreground md:hover:text-foreground")})}),c&&!y&&(0,t.jsx)(g.K,{project:s})]})]})},y=(0,r.memo)(e=>{let{projects:s,isLoading:l,showAvatar:a=!0,placeholderCount:r=8,selectedCategory:n,subtitleType:i,noProjectsMessage:c="No projects found",showStars:d=!1,onToggleStar:o,showActionsDropdown:u=!0,getHref:m,getOnClick:x,getImagePreviewButtonText:p,selectionMode:f=!1,selectedProjectIds:v,onSelectionChange:g,onSelectAll:b,isAllSelected:y=!1,isPartiallySelected:k=!1}=e;return l||s&&0!==s.length?(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 border-b border-muted px-3 pb-1.5 text-sm font-medium text-muted-foreground",children:[f&&(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)(h.S,{checked:y,onCheckedChange:b,className:(0,j.cn)("h-5 w-5",k&&"data-[state=checked]:bg-muted-foreground")})}),(0,t.jsx)("div",{className:"w-[126px] flex-shrink-0"}),(0,t.jsx)("div",{className:"min-w-0 flex-[6]",children:"Name"}),(0,t.jsx)("div",{className:"flex-[3] overflow-hidden",children:"Created at"}),(0,t.jsx)("div",{className:"flex-[3] overflow-hidden",children:"Created by"}),(d||u)&&(0,t.jsx)("div",{className:"w-20 flex-shrink-0"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[s.map((e,s)=>(0,t.jsx)(w,{project:e,showAvatar:a,subtitleType:i,showStars:d,onToggleStar:o,showActionsDropdown:u,linkHref:null==m?void 0:m(e,s),onClick:null==x?void 0:x(e,s),imagePreviewButtonText:null==p?void 0:p(e),selectionMode:f,isSelected:(null==v?void 0:v.has(e.id))||!1,onSelectionChange:g,isFirst:0===s},e.id)),l&&Array.from({length:r}).map((e,s)=>(0,t.jsx)(N,{},s))]})]}):(0,t.jsx)("div",{className:"text-center text-sm text-muted-foreground",children:c})});y.displayName="ProjectsListView";var k=l(83220),S=l(31088),C=l(20247),_=l(72064);function A(e){let{open:s,onOpenChange:l,projects:a,workspaceId:n,onSuccess:i}=e,[c,d]=(0,r.useState)(null),{folders:o,isLoading:u}=(0,_.ow)(n),h=(0,_._U)(n),p=async()=>{if(!c)return;let e=a.map(e=>e.id);await h.mutateAsync({folderId:c,projectIds:e}),null==i||i(),l(!1),d(null)},f=a.length,v=1===f?"project":"projects",g=null==o?void 0:o.find(e=>e.id===c);return(0,t.jsx)(C.lG,{open:s,onOpenChange:e=>{l(e),e||d(null)},children:(0,t.jsxs)(C.Cf,{className:"sm:max-w-[480px]",children:[(0,t.jsxs)(C.c7,{children:[(0,t.jsx)(C.L3,{children:"Move to folder"}),(0,t.jsxs)(C.rr,{children:["Select a folder to move the selected ",v," to."]})]}),(0,t.jsx)("div",{className:"w-full overflow-hidden py-4",children:u?(0,t.jsx)("div",{className:"flex h-[240px] items-center justify-center",children:(0,t.jsx)(x.A,{name:"progress_activity",className:"h-6 w-6 animate-spin text-muted-foreground"})}):o&&0!==o.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"h-[240px] overflow-y-auto overflow-x-hidden pr-2",children:(0,t.jsx)("div",{className:"space-y-1",children:o.map(e=>(0,t.jsxs)("button",{onClick:()=>d(e.id),className:(0,j.cn)("flex w-full items-center gap-3 overflow-hidden rounded-lg border-2 border-transparent px-3 py-2 text-left transition-colors","hover:bg-muted",c===e.id&&"border-primary bg-muted"),children:[(0,t.jsx)(x.A,{name:"folder",className:(0,j.cn)("h-5 w-5 flex-shrink-0",!e.color&&"text-muted-foreground"),style:e.color?{color:e.color}:void 0}),(0,t.jsxs)("div",{className:"min-w-0 flex-1 overflow-hidden",children:[(0,t.jsx)("p",{className:"truncate text-sm",children:e.name}),e.description&&(0,t.jsx)("p",{className:"truncate text-xs text-muted-foreground",children:e.description})]})]},e.id))})}),(0,t.jsx)("div",{className:"min-h-[20px]",children:g&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(x.A,{name:"info",className:"h-4 w-4 flex-shrink-0 text-muted-foreground"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[f," ",v," selected → ",(0,t.jsx)("span",{className:"font-medium",children:g.name})]})]})})]}):(0,t.jsxs)("div",{className:"flex h-[240px] flex-col items-center justify-center text-center",children:[(0,t.jsx)(x.A,{name:"folder",className:"mx-auto mb-3 h-12 w-12 text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No folders available"}),(0,t.jsx)("p",{className:"mt-1 text-xs text-muted-foreground",children:"Create a folder first to organize your projects"})]})}),(0,t.jsxs)(C.Es,{children:[(0,t.jsx)(m.$,{variant:"ghost",onClick:()=>l(!1),disabled:h.isPending,className:"hover:bg-muted",children:"Cancel"}),(0,t.jsx)(m.$,{onClick:p,disabled:!c||h.isPending,children:h.isPending?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{name:"progress_activity",className:"mr-2 h-4 w-4 animate-spin"}),"Moving..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{name:"folder_plus",className:"mr-2 h-4 w-4"}),"Move to folder"]})})]})]})})}var P=l(6698),M=l(39896),E=l(6397),I=l(6676);function T(e){let{open:s,onOpenChange:l,projects:a,onSuccess:n}=e,[i,c]=(0,r.useState)(""),d=(0,P.n)({mutationFn:async()=>{let e=a.map(e=>(0,I.x)(e.id)),s=await Promise.allSettled(e),l=s.filter(e=>"rejected"===e.status);if(l.length>0)throw Error("Failed to delete ".concat(l.length," project(s)"));return s},onSuccess:()=>{null==n||n(),l(!1)},onError:e=>{S.toast.error(e.message||"Failed to delete some projects. Please try again.")}}),o=a.length,u=1===o?"project":"projects",h=i==="DELETE ".concat(o);return(0,t.jsx)(M.Lt,{open:s,onOpenChange:e=>{e||c(""),l(e)},children:(0,t.jsxs)(M.EO,{children:[(0,t.jsxs)(M.wd,{children:[(0,t.jsxs)(M.r7,{children:["Delete ",o," ",u,"?"]}),(0,t.jsxs)(M.$v,{className:"space-y-2",children:[(0,t.jsxs)("p",{children:["Are you sure you want to delete ",o," ",u,"? This action cannot be undone."]}),o<=5&&(0,t.jsxs)("div",{className:"mt-3 rounded-md bg-muted p-3",children:[(0,t.jsx)("p",{className:"mb-2 text-sm font-medium",children:"Projects to delete:"}),(0,t.jsx)("ul",{className:"space-y-1 text-sm text-muted-foreground",children:a.map(e=>(0,t.jsxs)("li",{className:"whitespace-pre-wrap",children:["• ",e.display_name||e.name||"Untitled"]},e.id))})]}),(0,t.jsxs)("div",{className:"mt-4 flex flex-col gap-2",children:[(0,t.jsxs)("p",{className:"text-sm",children:["To confirm deletion, type ",(0,t.jsxs)("span",{className:"font-medium",children:["DELETE ",o]})," below:"]}),(0,t.jsx)(E.p,{placeholder:"Type DELETE ".concat(o),value:i,onChange:e=>c(e.target.value),autoFocus:!0}),(0,t.jsxs)("div",{className:"flex items-center gap-1 px-1 text-sm text-destructive-primary",children:[(0,t.jsx)(x.A,{name:"warning",className:"text-destructive-primary",size:"small"}),"This action is irreversible!"]})]})]})]}),(0,t.jsxs)(M.ck,{children:[(0,t.jsx)(M.Zr,{disabled:d.isPending,children:"Cancel"}),(0,t.jsx)(m.$,{variant:"destructive",size:"sm",onClick:()=>{d.mutate()},disabled:!h||d.isPending,children:d.isPending?"Deleting ".concat(o," ").concat(u,"..."):"Delete ".concat(o," ").concat(u)})]})]})})}var z=l(57841),F=l(86386),B=l(18502),D=l(40702),L=l(99989),$=l(36119);function O(e){let{open:s,onOpenChange:l,projects:a,currentWorkspaceId:n,onSuccess:i}=e,[c,d]=(0,r.useState)(null),{workspaces:o,isLoading:u}=function(){let{authUser:e}=(0,D.Z2)(),{data:s,isLoading:l,error:t}=(0,B.I)(L.y.workspaces({userId:null==e?void 0:e.uid,disabled:!e||!(0,$.H)(e)}));return{workspaces:(null==s?void 0:s.workspaces)||[],isLoading:l,error:t}}(),h=(0,P.n)({mutationFn:async e=>{let s=a.map(s=>(0,I.D)(s.id,e)),l=await Promise.allSettled(s),t=l.filter(e=>"rejected"===e.status);if(t.length>0)throw Error("Failed to move ".concat(t.length," project(s)"));return l},onSuccess:()=>{null==i||i(),l(!1),d(null)},onError:e=>{S.toast.error(e.message||"Failed to move projects to workspace. Please try again.")}}),p=a.length,f=1===p?"project":"projects",v=null==o?void 0:o.filter(e=>e.id!==n),g=null==o?void 0:o.find(e=>e.id===c);return(0,t.jsx)(C.lG,{open:s,onOpenChange:e=>{l(e),e||d(null)},children:(0,t.jsxs)(C.Cf,{className:"sm:max-w-[480px]",children:[(0,t.jsxs)(C.c7,{children:[(0,t.jsx)(C.L3,{children:"Move to workspace"}),(0,t.jsxs)(C.rr,{children:["Select a workspace to move the selected ",f," to."]})]}),(0,t.jsx)("div",{className:"py-4",children:u?(0,t.jsx)("div",{className:"flex h-[240px] items-center justify-center",children:(0,t.jsx)(x.A,{name:"progress_activity",className:"h-6 w-6 animate-spin text-muted-foreground"})}):v&&0!==v.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(F.F,{className:"h-[240px] pr-4",children:(0,t.jsx)("div",{className:"space-y-1",children:v.map(e=>(0,t.jsxs)("button",{onClick:()=>d(e.id),className:(0,j.cn)("flex w-full items-center gap-3 rounded-lg border-2 border-transparent px-3 py-2 text-left transition-colors","hover:bg-muted",c===e.id&&"border-primary bg-muted"),children:[(0,t.jsx)(z.z,{workspace:e,className:"h-8 w-8 flex-shrink-0"}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"truncate text-sm",children:e.name}),void 0!==e.is_personal&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.is_personal?"Personal workspace":"Team workspace"})]}),void 0!==e.num_projects&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.num_projects," ",1===e.num_projects?"project":"projects"]})]},e.id))})}),(0,t.jsx)("div",{className:"mt-2 min-h-[20px]",children:g&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(x.A,{name:"info",className:"h-4 w-4 flex-shrink-0 text-muted-foreground"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[p," ",f," selected →"," ",(0,t.jsx)("span",{className:"font-medium",children:g.name})]})]})})]}):(0,t.jsxs)("div",{className:"flex h-[240px] flex-col items-center justify-center text-center",children:[(0,t.jsx)(x.A,{name:"people",className:"mx-auto mb-3 h-12 w-12 text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No other workspaces available"}),(0,t.jsx)("p",{className:"mt-1 text-xs text-muted-foreground",children:"You need to be a member of other workspaces to move projects"})]})}),(0,t.jsxs)(C.Es,{children:[(0,t.jsx)(m.$,{variant:"ghost",onClick:()=>l(!1),disabled:h.isPending,className:"hover:bg-muted",children:"Cancel"}),(0,t.jsx)(m.$,{onClick:()=>{c&&h.mutate(c)},disabled:!c||h.isPending,children:h.isPending?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{name:"progress_activity",className:"mr-2 h-4 w-4 animate-spin"}),"Moving..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{name:"people",className:"mr-2 h-4 w-4"}),"Move to workspace"]})})]})]})})}function V(e){let{open:s,onOpenChange:l,projects:a,folderId:r,onSuccess:n}=e,i=(0,k.j4)(e=>e.currentWorkspace),c=(0,_.eJ)(null==i?void 0:i.id),d=async()=>{let e=a.map(e=>e.id);try{await c.mutateAsync({folderId:r,projectIds:e}),null==n||n(),l(!1)}catch(e){}},o=a.length,u=1===o?"project":"projects";return(0,t.jsx)(M.Lt,{open:s,onOpenChange:l,children:(0,t.jsxs)(M.EO,{children:[(0,t.jsxs)(M.wd,{children:[(0,t.jsxs)(M.r7,{children:["Remove ",o," ",u," from folder?"]}),(0,t.jsxs)(M.$v,{className:"space-y-2",children:[(0,t.jsxs)("p",{children:["Are you sure you want to remove ",o," ",u," from this folder? The ",u," will remain in your workspace."]}),o<=5&&(0,t.jsxs)("div",{className:"mt-3 rounded-md bg-muted p-3",children:[(0,t.jsx)("p",{className:"mb-2 text-sm font-medium",children:"Projects to remove:"}),(0,t.jsx)("ul",{className:"space-y-1 text-sm text-muted-foreground",children:a.map(e=>(0,t.jsxs)("li",{className:"truncate",children:["• ",e.display_name||e.name||"Untitled"]},e.id))})]})]})]}),(0,t.jsxs)(M.ck,{children:[(0,t.jsx)(M.Zr,{disabled:c.isPending,children:"Cancel"}),(0,t.jsx)(m.$,{size:"sm",onClick:d,disabled:c.isPending,children:c.isPending?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{name:"progress_activity",className:"mr-2 h-4 w-4 animate-spin"}),"Removing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{name:"folder",className:"mr-2 h-4 w-4"}),"Remove from folder"]})})]})]})})}var U=l(58295);function Q(e){let{selectedProjects:s,onClearSelection:l,className:a,currentFolderId:n,currentWorkspaceId:i,onActionComplete:c,isAllSelected:d=!1,isPartiallySelected:o=!1,onSelectAll:u,totalProjectsCount:p,onCancel:f}=e,[v,g]=(0,r.useState)(!1),[b,N]=(0,r.useState)(!1),[w,y]=(0,r.useState)(!1),[k,C]=(0,r.useState)(!1),_=s.length,P=()=>{l(),null==c||c()};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:(0,j.cn)("fixed bottom-4 left-1/2 z-30 flex w-[calc(100%-2rem)] -translate-x-1/2 items-center gap-2 rounded-xl border bg-background/95 px-3 py-2.5 shadow-lg backdrop-blur-sm sm:w-fit sm:px-4",a),children:[u&&(0,t.jsx)(U.Bc,{delayDuration:300,children:(0,t.jsxs)(U.m_,{children:[(0,t.jsx)(U.k$,{asChild:!0,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(h.S,{checked:d,onCheckedChange:u,className:(0,j.cn)("h-5 w-5",o&&"data-[state=checked]:bg-muted-foreground")}),(0,t.jsx)("button",{onClick:()=>u(!d),className:"text-sm font-medium hover:underline",children:_>0?"".concat(_," selected"):"Select all".concat(p?" (".concat(p,")"):"")})]})}),(0,t.jsx)(U.ZI,{side:"top",children:(0,t.jsxs)("span",{className:"text-xs",children:[(0,t.jsx)("kbd",{className:"rounded bg-background/10 px-1.5 py-0.5 text-[11px] font-medium",children:"⌘A"}),(0,t.jsx)("span",{className:"mx-1 opacity-50",children:"/"}),(0,t.jsx)("kbd",{className:"rounded bg-background/10 px-1.5 py-0.5 text-[11px] font-medium",children:"Ctrl+A"})]})})]})}),_>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"h-5 w-px bg-border"}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 overflow-x-auto",children:[n?(0,t.jsxs)(m.$,{variant:"ghost",size:"sm",onClick:()=>C(!0),className:"h-8 min-w-fit gap-1.5 px-2 hover:bg-muted sm:px-3",children:[(0,t.jsx)(x.A,{name:"folder",size:"small"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Remove from folder"})]}):(0,t.jsxs)(m.$,{variant:"ghost",size:"sm",onClick:()=>N(!0),className:"h-8 min-w-fit gap-1.5 px-2 hover:bg-muted sm:px-3",children:[(0,t.jsx)(x.A,{name:"folder_plus",size:"small"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Move to folder"})]}),(0,t.jsxs)(m.$,{variant:"ghost",size:"sm",onClick:()=>y(!0),className:"h-8 min-w-fit gap-1.5 px-2 hover:bg-muted sm:px-3",children:[(0,t.jsx)(x.A,{name:"people",size:"small"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Transfer"})]}),(0,t.jsx)("div",{className:"h-5 w-px bg-border"}),(0,t.jsxs)(m.$,{variant:"ghost",size:"sm",onClick:()=>g(!0),className:"h-8 min-w-fit gap-1.5 px-2 text-destructive-primary hover:bg-destructive/10 hover:text-destructive-primary sm:px-3",children:[(0,t.jsx)(x.A,{name:"trash",size:"small"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Delete"})]})]})]}),(0,t.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[_>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"h-5 w-px bg-border"}),(0,t.jsx)(U.Bc,{delayDuration:300,children:(0,t.jsxs)(U.m_,{children:[(0,t.jsx)(U.k$,{asChild:!0,children:(0,t.jsx)(m.$,{variant:"ghost",size:"sm",onClick:l,className:"h-8 px-2 hover:bg-muted",children:"Clear"})}),(0,t.jsx)(U.ZI,{side:"top",children:(0,t.jsxs)("span",{className:"text-xs",children:[(0,t.jsx)("kbd",{className:"rounded bg-background/10 px-1.5 py-0.5 text-[11px] font-medium",children:"⌘D"}),(0,t.jsx)("span",{className:"mx-1 opacity-50",children:"/"}),(0,t.jsx)("kbd",{className:"rounded bg-background/10 px-1.5 py-0.5 text-[11px] font-medium",children:"Ctrl+D"})]})})]})})]}),(0,t.jsx)("div",{className:"h-5 w-px bg-border"}),(0,t.jsx)(U.Bc,{delayDuration:300,children:(0,t.jsxs)(U.m_,{children:[(0,t.jsx)(U.k$,{asChild:!0,children:(0,t.jsx)(m.$,{variant:"ghost",size:"sm",onClick:f,className:"h-8 px-3 hover:bg-muted",children:"Cancel"})}),(0,t.jsx)(U.ZI,{side:"top",children:(0,t.jsx)("kbd",{className:"rounded bg-background/10 px-1.5 py-0.5 text-[11px] font-medium",children:"Esc"})})]})})]})]}),(0,t.jsx)(T,{open:v,onOpenChange:g,projects:s,onSuccess:()=>{S.toast.success("Successfully deleted ".concat(_," project").concat(1===_?"":"s",".")),P()}}),(0,t.jsx)(A,{open:b,onOpenChange:N,projects:s,workspaceId:i,onSuccess:()=>{S.toast.success("Successfully added ".concat(_," project").concat(1===_?"":"s"," to folder.")),P()}}),n&&(0,t.jsx)(V,{open:k,onOpenChange:C,projects:s,folderId:n,onSuccess:()=>{S.toast.success("Successfully removed ".concat(_," project").concat(1===_?"":"s"," from folder.")),P()}}),(0,t.jsx)(O,{open:w,onOpenChange:y,projects:s,currentWorkspaceId:i,onSuccess:()=>{S.toast.success("Successfully moved ".concat(_," project").concat(1===_?"":"s"," to workspace.")),P()}})]})}var R=l(52597),W=l(53103),Z=l(19620),K=l(86686),G=l(21562),H=l(37962),q=l(35762),Y=l(28717),J=l(69958),X=l(8711),ee=l(89002),es=l(43010);let el=[{value:"updated_at",label:"Last edited"},{value:"created_at",label:"Date created"},{value:"name",label:"Alphabetical"}],et=e=>{switch(e){case"updated_at":case"created_at":return[{value:"desc",label:"Newest first"},{value:"asc",label:"Oldest first"}];case"name":return[{value:"asc",label:"A–Z"},{value:"desc",label:"Z–A"}];default:return[]}},ea=[{value:"all",label:"Any status"},{value:"published",label:"All published"},{value:"internally_published",label:"Internally published"},{value:"externally_published",label:"Externally published"},{value:"unpublished",label:"Not published"}],er=e=>{var s,l,a,n,i;let{searchQuery:c,setSearchQuery:d,selectedUserId:o,setSelectedUserId:u,sortBy:h,setSortBy:p,order:f,setOrder:v,publishStatus:g="all",setPublishStatus:b,visibility:N,setVisibility:w,workspaceId:y,viewType:S="grid",setViewType:C,hideCreatorFilter:_=!1,hideSearch:A=!1,hideSort:P=!1,hideVisibilityFilter:M=!1,hideViewToggle:I=!1,hidePublishStatus:T=!1,searchPlaceholder:z="Search projects...",className:F}=e,B=(0,k.j4)(e=>e.currentWorkspace),[D,L]=(0,r.useState)(!1),[$,O]=(0,r.useState)(!1),[V,U]=(0,r.useState)(!1),[Q,R]=(0,r.useState)(!1),[W,Z]=(0,r.useState)(""),G=(0,K.d7)(W,300),{members:H,isLoading:q,fetchNextPage:er,hasNextPage:en,isFetchingNextPage:ei}=(0,es.v)({workspaceId:y,searchQuery:G}),ec=(0,k.j4)(e=>e.membership),ed=(0,Y.W6)({workspacePlan:null!=(i=null==B?void 0:B.plan)?i:null}),eo=et(h),eu=(0,r.useMemo)(()=>(e=>{let s=[{value:"all",label:"Any visibility"}];return s.push({value:"public",label:"Public"},{value:"workspace",label:"Workspace"}),e&&s.push({value:"personal",label:"Personal"}),s})(ed),[ed]);r.useEffect(()=>{ed||"personal"!==N||w("all")},[ed,N,w]);let em=G.length<3,eh=(0,r.useMemo)(()=>[{value:"all",label:"All creators"},...(null==ec?void 0:ec.user_id)&&em?[{value:null==ec?void 0:ec.user_id,label:"".concat((null==ec?void 0:ec.display_name)||(null==ec?void 0:ec.email)," (You)")}]:[],...H.filter(e=>e.user_id!==(null==ec?void 0:ec.user_id)||!em).map(e=>({value:e.user_id,label:"".concat(e.display_name||e.email)}))],[ec,em,H]),ex=(0,r.useCallback)(e=>{if(en&&!ei&&!q){let{scrollTop:s,scrollHeight:l,clientHeight:t}=e.currentTarget;(s+t)/l>=.8&&er()}},[en,ei,q,er]);return A&&P&&_&&M?null:(0,t.jsxs)("div",{className:(0,j.cn)("flex flex-col gap-4 md:justify-between lg:flex-row",F),children:[!A&&(0,t.jsxs)("div",{className:"relative h-fit w-full lg:w-60",children:[(0,t.jsx)(x.A,{name:"search",className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,t.jsx)(E.p,{type:"text",placeholder:z,value:c,onChange:e=>d(e.target.value),className:"!rounded-xl bg-background pl-9 pr-9"}),c&&(0,t.jsx)(m.$,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 h-6 w-6 -translate-y-1/2 p-0",onClick:()=>d(""),children:(0,t.jsx)(x.A,{name:"x",className:"h-3 w-3"})})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(!P||!_||!M)&&(0,t.jsxs)("div",{className:"grid w-full grid-cols-2 gap-2 sm:flex sm:flex-row sm:flex-wrap sm:items-center sm:justify-end",children:[!P&&(0,t.jsxs)(X.rI,{open:$,onOpenChange:O,children:[(0,t.jsx)(X.ty,{asChild:!0,children:(0,t.jsxs)(m.$,{variant:"input",className:"h-9 w-full justify-between !rounded-xl hover:max-sm:bg-transparent md:w-36",children:[(0,t.jsx)("span",{className:"truncate text-left",children:(null==(s=el.find(e=>e.value===h))?void 0:s.label)||"Sort"}),(0,t.jsx)(x.A,{name:"chevron_down",size:"default"})]})}),(0,t.jsxs)(X.SQ,{className:"border-input p-1",align:"start",children:[(0,t.jsx)(X.lp,{children:"Sort by"}),(0,t.jsx)(X.mB,{className:"bg-input"}),el.map(e=>(0,t.jsxs)(X._2,{onSelect:s=>{null==s||s.preventDefault(),p(e.value);let l=et(e.value)[0];l&&v(l.value)},className:"cursor-pointer",children:[e.label,(0,t.jsx)(x.A,{name:"check",size:"small",className:(0,j.cn)("ml-auto",h===e.value?"opacity-100":"opacity-0")})]},e.value)),(0,t.jsx)(X.mB,{className:"bg-input"}),(0,t.jsx)(X.lp,{children:"Order"}),(0,t.jsx)(X.mB,{className:"bg-input"}),eo.map(e=>(0,t.jsxs)(X._2,{onSelect:s=>{null==s||s.preventDefault(),v(e.value)},className:"cursor-pointer",children:[e.label,(0,t.jsx)(x.A,{name:"check",size:"small",className:(0,j.cn)("ml-auto",f===e.value?"opacity-100":"opacity-0")})]},e.value))]})]}),!M&&(0,t.jsxs)(X.rI,{open:V,onOpenChange:U,children:[(0,t.jsx)(X.ty,{asChild:!0,children:(0,t.jsxs)(m.$,{variant:"all"!==N?"default":"input",className:"h-9 w-full justify-between !rounded-xl hover:max-sm:bg-transparent md:w-36",children:[(0,t.jsx)("span",{className:"truncate text-left",children:(null==(l=eu.find(e=>e.value===N))?void 0:l.label)||"Visibility"}),(0,t.jsx)(x.A,{name:"chevron_down",size:"default"})]})}),(0,t.jsxs)(X.SQ,{className:"border-input p-1",align:"start",children:[(0,t.jsx)(X.lp,{children:"Visibility"}),(0,t.jsx)(X.mB,{className:"bg-input"}),eu.map(e=>(0,t.jsxs)(X._2,{onSelect:()=>{w(e.value)},className:"cursor-pointer",children:[e.label,(0,t.jsx)(x.A,{name:"check",size:"small",className:(0,j.cn)("ml-auto",N===e.value?"opacity-100":"opacity-0")})]},e.value))]})]}),!T&&"function"==typeof b&&(0,t.jsxs)(X.rI,{open:Q,onOpenChange:R,children:[(0,t.jsx)(X.ty,{asChild:!0,children:(0,t.jsxs)(m.$,{variant:g&&"all"!==g?"default":"input",className:"h-9 w-full justify-between !rounded-xl hover:max-sm:bg-transparent md:w-36",children:[(0,t.jsx)("span",{className:"truncate text-left",children:(null==(a=ea.find(e=>e.value===(g||"all")))?void 0:a.label)||"Publish status"}),(0,t.jsx)(x.A,{name:"chevron_down",size:"default"})]})}),(0,t.jsxs)(X.SQ,{className:"border-input p-1",align:"start",children:[(0,t.jsx)(X.lp,{children:"Publish status"}),(0,t.jsx)(X.mB,{className:"bg-input"}),ea.map(e=>{let s=(g||"all")===e.value;return(0,t.jsxs)(X._2,{onSelect:()=>{b(e.value)},className:"cursor-pointer",children:[e.label,(0,t.jsx)(x.A,{name:"check",size:"small",className:(0,j.cn)("ml-auto",s?"opacity-100":"opacity-0")})]},e.value)})]})]}),!_&&(0,t.jsxs)(ee.AM,{open:D,onOpenChange:L,children:[(0,t.jsx)(ee.Wv,{asChild:!0,children:(0,t.jsxs)(m.$,{variant:"all"!==o?"default":"input",role:"combobox","aria-expanded":D,className:"h-9 w-full justify-between !rounded-xl hover:max-sm:bg-transparent md:w-36",children:[(0,t.jsx)("span",{className:"truncate text-left",children:(null==(n=eh.find(e=>e.value===o))?void 0:n.label)||"All creators"}),(0,t.jsx)(x.A,{name:"chevron_down",size:"default"})]})}),(0,t.jsxs)(ee.hl,{className:"w-[240px] border-input p-1",align:"start",children:[(0,t.jsx)(X.lp,{children:"Creator"}),(0,t.jsx)(X.mB,{className:"bg-input"}),(0,t.jsxs)(J.uB,{shouldFilter:!1,value:o,onValueChange:()=>{},children:[(0,t.jsx)(J.G7,{placeholder:"Search creators... ",value:W,onValueChange:Z,className:"h-9 border-input focus-visible:ring-0 focus-visible:ring-offset-0"}),(0,t.jsxs)(J.oI,{className:"max-h-72 overflow-auto",onScroll:ex,style:{overscrollBehavior:"contain"},children:[(0,t.jsx)(J.xL,{children:q?"Loading...":"No creators found."}),(0,t.jsx)(J.L$,{children:eh.map(e=>(0,t.jsxs)(J.h_,{value:e.value,onSelect:()=>{u(e.value),L(!1),Z("")},className:(0,j.cn)("max-w-[220px] cursor-pointer aria-selected:bg-transparent aria-selected:text-inherit data-[selected=true]:bg-transparent data-[selected=true]:text-inherit hover:bg-accent"),children:[(0,t.jsx)("span",{className:"truncate",children:e.label}),(0,t.jsx)(x.A,{name:"check",size:"small",className:(0,j.cn)("ml-auto opacity-0",{"opacity-100":o===e.value})})]},e.value))}),ei&&(0,t.jsx)("div",{className:"flex w-full justify-center py-2",children:(0,t.jsx)(x.A,{name:"progress_activity",className:"h-4 w-4 animate-spin"})})]})]})]})]})]}),!I&&C&&(0,t.jsxs)("div",{className:"relative hidden h-fit !rounded-xl bg-muted p-1 md:block",children:[(0,t.jsx)("div",{className:"absolute inset-y-1 !rounded-lg bg-background shadow-sm transition-all duration-150 ease-out",style:{left:"grid"===S?"4px":"calc(50%)",width:"calc(50% - 4px)"}}),(0,t.jsxs)("div",{className:"relative flex",children:[(0,t.jsx)("button",{onClick:()=>C("grid"),className:(0,j.cn)("relative z-10 flex h-7 w-9 items-center justify-center !rounded-lg transition-colors duration-100","grid"===S?"text-foreground":"text-muted-foreground hover:text-foreground"),"aria-label":"Grid view",type:"button",children:(0,t.jsx)(x.A,{name:"grid",className:"h-4 w-4"})}),(0,t.jsx)("button",{onClick:()=>C("list"),className:(0,j.cn)("relative z-10 flex h-7 w-9 items-center justify-center !rounded-lg transition-colors duration-100","list"===S?"text-foreground":"text-muted-foreground hover:text-foreground"),"aria-label":"List view",type:"button",children:(0,t.jsx)(x.A,{name:"list",className:"h-4 w-4"})})]})]})]})]})};var en=l(10580);let ei=e=>{let{projects:s,isLoading:l,showAvatar:i=!0,showStars:c=!1,onToggleStar:d,selectedCategory:o,subtitleType:u="edit-time",noProjectsMessage:h,filterConfig:x={},header:p,hasMoreFromBackend:f,onLoadMoreFromBackend:j,searchQuery:v,setSearchQuery:g,selectedUserId:b,setSelectedUserId:N,sortBy:w,setSortBy:S,order:C,setOrder:_,visibility:A,setVisibility:P,publishStatus:M,setPublishStatus:E,getHref:I,getOnClick:T,getImagePreviewButtonText:z,initialViewType:F,renderBeforeProjects:B,enableBulkSelection:D=!1,currentFolderId:L,currentWorkspaceId:$,onBulkActionComplete:O}=e,V=(0,a.c3)("Common"),U=(0,k.j4)(e=>e.currentWorkspace),Y=(0,r.useRef)(!1),[J,X]=r.useState(!1),[ee,es]=r.useState(!1),el=(0,W.a)(),[et,ea]=r.useState(()=>{if(F)return F;{let e=localStorage.getItem("projectViewType");if("grid"===e||"list"===e)return e}return F||"grid"}),ei=r.useCallback(e=>{ea(e),localStorage.setItem("projectViewType",e)},[]);(0,r.useEffect)(()=>{F&&F!==et&&ea(F)},[F,et]),(0,r.useEffect)(()=>{el&&ea("grid")},[el]);let ec=void 0!==f&&void 0!==j,ed=void 0!==v||void 0!==b||void 0!==A||void 0!==M,eo=(e=>{let{projects:s,isLoading:l,pageSize:t=12,defaultSortBy:a="updated_at",defaultOrder:n="desc",resetKey:i,enableCreatorFilter:c=!0,enableSearch:d=!0,enableSort:o=!0,enableVisibilityFilter:u=!1,enablePublishStatusFilter:m=!1,defaultVisibility:h="all",defaultPublishStatus:x="all"}=e,[p,f]=(0,r.useState)(""),j=(0,K.d7)(p,300),[v,g]=(0,r.useState)(1),[b,N]=(0,r.useState)("all"),[w,y]=(0,r.useState)(a),[k,S]=(0,r.useState)(n),[C,_]=(0,r.useState)(h),[A,P]=(0,r.useState)(x);(0,r.useEffect)(()=>{i&&(N("all"),y(a),S(n),f(""),_(h),P(x),g(1))},[i,a,n,h,x]),(0,r.useEffect)(()=>{g(1)},[b,w,k,j,C,A]);let M=(0,r.useMemo)(()=>d&&(null==s?void 0:s.length)?new G.A(s,{keys:[{name:"name",weight:.5},{name:"description",weight:.5},{name:"tech_stack",weight:.3}],threshold:.5,includeScore:!0}):null,[s,d]),E=(0,r.useMemo)(()=>{if(!(null==s?void 0:s.length))return[];let e=[...s];if(c&&"all"!==b&&(e=e.filter(e=>e.user_id===b)),u&&"all"!==C&&(e=e.filter(e=>"personal"===C?"draft"===e.visibility:"workspace"===C?"private"===e.visibility:"public"!==C||"public"===e.visibility)),m&&"all"!==A&&(e=e.filter(e=>{let s=!0===e.is_published&&e.publish_visibility===q.B.Private,l=!0===e.is_published&&(null==e.publish_visibility||e.publish_visibility===q.B.Public);return"published"===A?s||l:"internally_published"===A?s:"externally_published"===A?l:"unpublished"!==A||!s&&!l})),d&&j.length>0&&M){let s=new Set(M.search(j).map(e=>e.item.id));e=e.filter(e=>s.has(e.id))}return o&&(e=(0,H.TU)(e,w,k)),e},[s,b,j,w,k,C,A,M,c,d,o,u,m]),I=(0,r.useMemo)(()=>E.slice(0,v*t),[E,v,t]),T=E.length>v*t,z=(0,r.useCallback)(()=>{T&&g(e=>e+1)},[T]);return{projects:I,allProjects:s,filteredProjects:E,isLoading:l,hasMore:T,showMore:z,searchQuery:d?p:"",setSearchQuery:d?f:()=>{},selectedUserId:c?b:"all",setSelectedUserId:c?N:()=>{},sortBy:o?w:a,setSortBy:o?y:()=>{},order:o?k:n,setOrder:o?S:()=>{},visibility:u?C:"all",setVisibility:u?_:()=>{},publishStatus:m?A:"all",setPublishStatus:m?P:()=>{}}})({projects:ec||ed?[]:s,isLoading:l,pageSize:12,defaultSortBy:"updated_at",defaultOrder:"desc",resetKey:null==U?void 0:U.id,enableCreatorFilter:!0,enableSearch:!0,enableSort:!0,enableVisibilityFilter:!1,enablePublishStatusFilter:!1,...x}),eu=void 0!==v?v:eo.searchQuery,em=g||eo.setSearchQuery,eh=void 0!==b?b:eo.selectedUserId,ex=N||eo.setSelectedUserId,ep=void 0!==w?w:eo.sortBy,ef=S||eo.setSortBy,ej=void 0!==C?C:eo.order,ev=_||eo.setOrder,eg=void 0!==A?A:eo.visibility,eb=P||eo.setVisibility,eN=void 0!==M?M:eo.publishStatus,ew=E||eo.setPublishStatus,ey=(0,r.useMemo)(()=>ec||ed?s:eo.projects,[ec,ed,s,eo.projects]),ek=(0,r.useMemo)(()=>ec||ed?f||!1:eo.hasMore,[ec,ed,f,eo.hasMore]),eS=(0,r.useMemo)(()=>ec||ed?j||(()=>{}):eo.showMore,[ec,ed,j,eo.showMore]),eC=r.useCallback(()=>{em(""),ex("all"),eb("all"),ew&&ew("all")},[em,ex,eb,ew]),{selectedProjectIds:e_,selectedProjects:eA,toggleProject:eP,clearSelection:eM,isAllSelected:eE,isPartiallySelected:eI,setSelectedProjectIds:eT}=function(e){let{projects:s}=e,[l,t]=(0,r.useState)(new Set),a=(0,r.useCallback)(e=>{t(s=>{let l=new Set(s);return l.has(e)?l.delete(e):l.add(e),l})},[]),n=(0,r.useCallback)(()=>{t(e=>e.size===s.length&&s.length>0?new Set:new Set(s.map(e=>e.id)))},[s]),i=(0,r.useCallback)(()=>{t(new Set)},[]),c=(0,r.useCallback)(e=>l.has(e),[l]),d=(0,r.useMemo)(()=>s.filter(e=>l.has(e.id)),[s,l]),o=(0,r.useMemo)(()=>s.length>0&&l.size===s.length,[s,l]),u=(0,r.useMemo)(()=>l.size>0&&l.size<s.length,[l,s]),m=l.size;return{selectedProjectIds:l,selectedProjects:d,toggleProject:a,toggleAll:n,clearSelection:i,isProjectSelected:c,isAllSelected:o,isPartiallySelected:u,selectionCount:m,setSelectedProjectIds:t}}({projects:ey||[]}),ez=(0,r.useCallback)(e=>{e?eT(new Set((null==ey?void 0:ey.map(e=>e.id))||[])):eM()},[eT,ey,eM]);(0,r.useEffect)(()=>{ee||eM()},[ee,eM]),(0,r.useEffect)(()=>{eM(),es(!1)},[null==U?void 0:U.id,L,eM,es]),(0,r.useEffect)(()=>{if(!ee)return;let e=e=>{"Escape"===e.key&&(es(!1),eM()),(e.metaKey||e.ctrlKey)&&"a"===e.key&&(e.preventDefault(),ez(!eE)),(e.metaKey||e.ctrlKey)&&"d"===e.key&&(e.preventDefault(),eM())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[ee,es,eM,eE,ez]);let eF=(0,r.useMemo)(()=>ec?f:ek,[ec,f,ek]),eB=(0,r.useMemo)(()=>ec?j||(()=>{}):eS,[ec,j,eS]),eD=l&&void 0===ey,eL=!l&&void 0!==ey&&0===ey.length,e$=eu||"all"!==eh||"all"!==eg||eN&&"all"!==eN,eO=eL&&e$&&((null==s?void 0:s.length)||0)>0,eV=(0,r.useRef)(null),eU=(0,r.useRef)(eB);(0,r.useEffect)(()=>{eU.current=eB},[eB]),(0,r.useEffect)(()=>{let e=eV.current;if(e&&eF)try{let s=new IntersectionObserver(e=>{let[s]=e;s.isIntersecting&&!Y.current&&(Y.current=!0,eU.current())},{rootMargin:"100px",threshold:.1});return s.observe(e),()=>{s.disconnect()}}catch(e){Z.logging.error("projects_view_observer_setup_error",{error:e}),X(!0);return}},[eF]);let eQ=(0,r.useMemo)(()=>{if(u)return u;switch(ep){case"updated_at":case"name":default:return"edit-time";case"created_at":return"create-time"}},[u,ep]),eR=(0,r.useMemo)(()=>(null==x?void 0:x.enableSearch)===!1&&(null==x?void 0:x.enableSort)===!1&&(null==x?void 0:x.enableCreatorFilter)===!1&&(null==x?void 0:x.enableVisibilityFilter)===!1?null:(0,t.jsx)(er,{searchQuery:eu,setSearchQuery:em,selectedUserId:eh,setSelectedUserId:ex,sortBy:ep,setSortBy:ef,order:ej,setOrder:ev,visibility:eg,setVisibility:eb,publishStatus:eN,setPublishStatus:ew,workspaceId:(null==U?void 0:U.id)||"",viewType:et,setViewType:ei,hideCreatorFilter:(null==x?void 0:x.enableCreatorFilter)===!1,hideSearch:(null==x?void 0:x.enableSearch)===!1,hideSort:(null==x?void 0:x.enableSort)===!1,hideVisibilityFilter:(null==x?void 0:x.enableVisibilityFilter)===!1,hidePublishStatus:(null==x?void 0:x.enablePublishStatusFilter)===!1,hideViewToggle:!1,searchPlaceholder:(null==x?void 0:x.searchPlaceholder)||"Search projects..."}),[null==U?void 0:U.id,eu,em,eh,ex,ep,ef,ej,ev,eg,eb,eN,ew,x,et,ei]);(0,r.useEffect)(()=>{Y.current=!1},[null==ey?void 0:ey.length]);let eW=(0,r.useMemo)(()=>p?(0,t.jsx)("div",{className:"bg-background pb-4 pt-8 sm:px-8",children:p}):eR?(0,t.jsx)("div",{className:"bg-background pb-4 pt-8 sm:px-8",children:eR}):null,[p,eR]);return(0,t.jsxs)("div",{className:"relative flex h-full flex-col",children:[eW,(0,t.jsx)("div",{className:"relative flex-1 overflow-y-auto overflow-x-hidden",children:eO?(0,t.jsx)("div",{className:"absolute inset-0 flex justify-center",children:(0,t.jsx)(en.y,{imageSrc:"/img/no-projects-filter.png",imageAlt:"No projects match filters",title:"No projects match your filters",subtitle:"Try adjusting your search or filters",buttonText:"Clear filters",onButtonClick:eC})}):(0,t.jsx)("div",{className:"pb-8 sm:px-8",children:(0,t.jsxs)("div",{className:"flex flex-col gap-5",children:[B&&B(),"grid"===et?(0,t.jsx)(n.D,{className:"gap-5",projects:ey||[],isLoading:eD,showAvatar:i,selectedCategory:o,subtitleType:eQ,noProjectsMessage:h,placeholderCount:12,skeletonBackgroundColor:"bg-muted-hover",showStars:c,onToggleStar:d,getHref:I,getOnClick:T,getImagePreviewButtonText:z,selectionMode:ee,selectedProjectIds:e_,onSelectionChange:eP,onSelectModeToggle:e=>{es(!0),e&&eP(e)},enableBulkSelection:D}):(0,t.jsx)(y,{projects:ey||[],isLoading:eD,showAvatar:i,selectedCategory:o,subtitleType:eQ,noProjectsMessage:h,placeholderCount:12,showStars:c,onToggleStar:d,getHref:I,getOnClick:T,getImagePreviewButtonText:z,selectionMode:ee,selectedProjectIds:e_,onSelectionChange:eP,onSelectAll:ez,isAllSelected:eE,isPartiallySelected:eI}),eF&&(0,t.jsx)("div",{ref:eV,className:"h-px","aria-hidden":"true"}),eF&&!J&&(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 py-4",role:"status",children:[(0,t.jsx)(R.y,{size:"small"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:V("loading")})]}),eF&&J&&(0,t.jsx)("div",{className:"flex justify-center py-4",children:(0,t.jsx)(m.$,{onClick:eB,children:V("showMore")})})]})})}),ee&&(0,t.jsx)(Q,{selectedProjects:eA,onClearSelection:eM,currentFolderId:L,currentWorkspaceId:$||(null==U?void 0:U.id),onActionComplete:()=>{es(!1),eM(),null==O||O()},isAllSelected:eE,isPartiallySelected:eI,onSelectAll:ez,totalProjectsCount:(null==ey?void 0:ey.length)||0,onCancel:()=>{es(!1),eM()}})]})}},86386:(e,s,l)=>{l.d(s,{F:()=>i});var t=l(77145),a=l(8250),r=l(95661),n=l(56024);let i=r.forwardRef((e,s)=>{let{className:l,children:r,viewportRef:i,...d}=e;return(0,t.jsxs)(a.bL,{ref:s,className:(0,n.cn)("relative overflow-hidden",l),...d,children:[(0,t.jsx)(a.LM,{ref:i,className:"h-full w-full rounded-[inherit]",children:r}),(0,t.jsx)(c,{}),(0,t.jsx)(a.OK,{})]})});i.displayName=a.bL.displayName;let c=r.forwardRef((e,s)=>{let{className:l,orientation:r="vertical",...i}=e;return(0,t.jsx)(a.VM,{ref:s,orientation:r,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-px","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-px",l),...i,children:(0,t.jsx)(a.lr,{className:"relative flex-1 rounded-full bg-border"})})});c.displayName=a.VM.displayName}}]);